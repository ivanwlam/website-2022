.et_pb_row .et_pb_module .et_pb_row {
  // Rows of nested modules 


	margin-top: 5rem;
	margin-bottom: 5rem;

  @media screen and (min-width: 768px) {
    margin-top: 7rem;
    margin-bottom: 7rem;
  }

  @media screen and (min-width: 1000px) {
    margin-top: 10rem;
    margin-bottom: 10rem;
  }

}

.et_pb_row .et_pb_module .et_pb_row.layout-portfolio-hero-row,
.et_pb_row .et_pb_module .et_pb_row.layout-portfolio-body-row-meta,
.et_pb_row .et_pb_module .et_pb_row.layout-portfolio-body-row-text-only {
	margin-top: 0;
	margin-bottom: 0;
}


.layout-portfolio-body-row {
	display: flex;
	align-items: center;
}

.layout-portfolio-body-row-columns-align-top {
  /* Make rows where there are multiple columns to align at the top */
  align-items: stretch;
}

/* Metadata headings */

.layout-portfolio-body-row-meta .heading-eyebrow {
  margin-bottom: 1rem !important; /* Override */
}

.layout-portfolio-body-row-meta .heading-eyebrow .et_pb_text_inner {
  /* Add underline to headings */
  display: inline-block;
  border-bottom: 1px solid var(--color-line);
  padding: 0 1em 0.5em 0;
}

.layout-portfolio-body-row.layout-portfolio-body-row-meta {
	align-items: start; /* override */
}


/* Typography */
.et_pb_title_container h1 {
	font-size: var(--font-size-h1);
}

.text-hero-body, .text-hero-body * {
  font-size: var(--font-size-h4);
  line-height: var(--line-height-h4);
}

.layout-body-row-super-blurb .et_pb_module p,
.layout-body-row-super-blurb .et_pb_module .et_pb_text_inner, 
.layout-portfolio-body-row-heading-main .et_pb_module p,
.layout-portfolio-body-row-heading-main .et_pb_module .et_pb_text_inner {
  /* Paragraph of high-level headings */
	font-size: var(--font-size-super-paragraph);
  line-height: var(--line-height-super-paragraph);
}


/* General Text Styles */
body .et_pb_row.layout-portfolio-body-row.layout-portfolio-body-row-heading-only {
  margin-bottom: 0;

  &+* {
    margin-top: 2rem; /* 2rem = by eye, not perfect */
  }
}

.layout-portfolio-body-row .et_pb_column .et_pb_module.et_pb_text {
  /* Spacing between portfolio body headings and subsequent paragraphs */

  margin-bottom: 1em; /* override defaults */

  & h2,
  & h3,
  & h4 {
    padding-bottom: 0;
  }
}

/* Portfolio Stats */

.layout-portfolio-stats-1-1 .et_pb_column,
.layout-portfolio-stats-t-1 .et_pb_column:nth-child(2) {
	border: 1px solid var(--color-line);
	padding: 2rem;
	border-radius: var(--border-radius-large);
}

.layout-portfolio-stats-t-1 .et_pb_column:nth-child(1) {
  display: flex;
  flex-direction: column;
  justify-content: center;
}

/* Portfolio Stat Category */
.text-portfolio-stat-category {
	height: calc(2 * var(--font-size-h5) * var(--line-height-h5));
}

.layout-portfolio-stats .heading-eyebrow h3 {
	font-family: var(--font-family-default) !important;
	font-size: var(--font-size-h5);
  line-height: var(--line-height-h5);
  padding-bottom: 0;
}

/* Portfolio Stat Value */
body .text-portfolio-stat-value,
body .text-portfolio-stat-value p {
	font-size: var(--font-size-super-heading); /* override */
  margin-bottom: 0 !important;
  padding-bottom: 1rem;
}

/* Portfolio Stat Description */

.text-portfolio-stat-description {
	height: calc(2 * var(--font-size-h4) * var(--line-height-h4));
}

.text-portfolio-stat-description * {
	font-size: var(--font-size-h4);
  margin-bottom: 0;
}



/* Sample Project Grid */

.et_pb_portfolio .et_pb_ajax_pagination_container {
  display: flex;
  // --column-gap: var(--spacing-extra-large);
  // column-gap: var(--column-gap);
  flex-wrap: wrap;

}

.et_pb_portfolio .et_pb_ajax_pagination_container h3 {
  font-size: var(--font-size-h5);
  line-height: var(--line-height-h5);
}

/* Project List Grid */
.et_pb_portfolio .et_pb_module_header,
.et_pb_portfolio_grid .et_pb_module_header {
	font-size: var(--font-size-h5) !important;
	line-height: var(--line-height-h5);
}

/* Projects Gallery Grid */
.et_pb_portfolio .et_pb_portfolio_item,
.et_pb_portfolio_grid_items .et_pb_post.project.type-project {
  margin-bottom: 3rem;
}

/* Projects Gallery Grid image container */
.et_portfolio_image {
  /* Crops image to 16:9 ratio and vertically center the image */
	aspect-ratio: 16/9;
	overflow: hidden;
	border-radius: var(--border-radius);
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.et_portfolio_image::after {
  /* Subtle vignette */
	content: "";
	display: block;
	width: 100%;
	height: 100%;
	position: absolute;
	left: 0;
	top: 0;
	background-image: radial-gradient(circle at center, transparent 0%, transparent 50%, hsla(0, 0%, 0%, 0.15 ) 100%);
}




@media screen and (min-width: 767px) {

  // .et_pb_portfolio .et_pb_ajax_pagination_container {
    /* Reset from default */
    // column-gap: 0;
    // flex-wrap: nowrap;
  // }

  body.project-template-default .et_pb_gutters3 .et_pb_column_4_4 .et_pb_portfolio_item {
    --margin-right: var(--spacing-extra-large);
  }

  body.page-template-default .et_pb_gutters3 .et_pb_column_4_4 .et_pb_portfolio_item {
    --margin-right: var(--spacing-extra-large);
  }

  .et_pb_gutters3 .et_pb_column_4_4 .et_pb_portfolio_item {
    --columns: 2;
    --gutters: calc(var(--columns) - 1);

    margin-right: var(--margin-right);
    width: calc((100% - (var(--gutters) * var(--margin-right))) / var(--columns));
  }
 
}

@media screen and (min-width: 1000px) {

  body.page-template-default .et_pb_gutters3 .et_pb_column_4_4 .et_pb_portfolio_item {
    --margin-right: var(--spacing-extra-extra-large);
  }
}

@media screen and (min-width: 767px) and (max-width: 1599px) {

  .et_pb_gutters3 .et_pb_column_4_4 .et_pb_portfolio_item:nth-child(2n) {
    margin-right: 0;
  }
  
}

@media screen and (min-width: 1599px) {
  body.project-template-default .et_pb_gutters3 .et_pb_column_4_4 .et_pb_portfolio_item {
    --columns: 4;
  }

  body.page-template-default .et_pb_gutters3 .et_pb_column_4_4 .et_pb_portfolio_item {
    --columns: 3;
  }

  body.project-template-default .et_pb_gutters3 .et_pb_column_4_4 .et_pb_portfolio_item:nth-child(4n),
  body.page-template-default .et_pb_gutters3 .et_pb_column_4_4 .et_pb_portfolio_item:nth-child(3n) {
    margin-right: 0;
  }

}

/* Images */

.layout-portfolio-hero-row :not(.background-image-none) > * > img, 
.layout-portfolio-body-row :not(.background-image-none) > * > img,
.layout-portfolio-body-row :not(.background-image-none) > * > video,
.et_pb_title_featured_container img {
  background: linear-gradient(180deg, hsl(119, 30%, 85%) 0%, hsl(202, 30%, 80%) 100%); // TODO: Make colors variables
}

.layout-portfolio-hero-row img, 
.layout-portfolio-body-row img,
.layout-portfolio-body-row video,
.et_pb_title_featured_container img {
  box-shadow: 0px 1px 1px hsla(0, 0%, 0%, 0.1); // TODO: Make colors variable
}

.single-project .et_pb_post_content .et_pb_image.et_pb_module,
.single-project .et_pb_post_content .et_pb_code.et_pb_module {
  margin-bottom: 0.5rem !important;
}

@media screen and (max-width:480px) {
  // Make image/media full viewport width on mobile screen width
  .et_pb_image .et_pb_image_wrap, 
  .et_pb_code_inner:has(> video) {
    max-width: 100vw !important; /* override */
    width: 100vw !important; /* override */
    margin-left: calc(-1 * var(--width-content-margin)); /* override */
  }

  .et_pb_image_wrap img, .et_pb_code_inner video {
    border-radius: 0; /* override */
}
}

@media screen and (prefers-color-scheme: dark) {
  // Add border to media in dark mode to make them stand out (in case they're in dark background)
  
  .et_pb_image_wrap img, .et_pb_code_inner video {
    border-width: 1px 0;
    border-style: solid;
    border-color: var(--color-line-opaque);

    @media screen and (min-width: 480px) {
      border-width: 1px;  
      border-radius: var(--border-radius-medium);
    }
  }

}

@keyframes effect-alternate-content {
  0% {opacity: 0;}
  45% {opacity: 0;}
  55% {opacity: 1;}
  100% {opacity: 1;}
}

.effect-alternate-content > .et_pb_image:not(:first-of-type) {
  /* Note: This selector: .et_pb_image:not(:first-of-type) allows targeting the second image, not the second child, which could be a caption (text) element. Also, it only works when there are two images to alternate. Use something else to make a series of changing images. */
	position: absolute;
	top: 0;
	opacity: 0;
  animation-direction: alternate;
  animation-name: effect-alternate-content;
  animation-duration: 3s;
  animation-iteration-count: infinite;
  
}


.et_pb_row .image-full-width-viewport {
	max-width: 100vw !important; /* override */
	width: 100vw;
	position: relative;
  margin-left: calc(-1 * var(--width-content-margin));
	overflow-x: hidden;
}

.et_pb_row .image-full-width-viewport .et_pb_image_wrap {
  overflow-x: scroll;
  overflow-y: hidden;
  width: 100vw;
}


/* Image Captions */
.et_pb_image.et_pb_module + .caption.et_pb_module .et_pb_text_inner,
.caption.et_pb_module .et_pb_text_inner {
	font-size: var(--font-size-sub-paragraph);
	font-style: italic;
	max-width: fit-content;
}

/* One Offs */

.et_pb_row .image-edu-dh-flow img {
  @media screen and (max-width: 480px) {
    --min-width: 60rem;
  }

  @media screen and (min-width: 480px) {
    --min-width: 90rem;
  }
  
  @media screen and (min-width: $breakpoint-desktop) {
    --min-width: 135rem;
  }

  min-width: 135rem;
  min-width: var(--min-width);

  /* estimated sizes
    desktop: 135rem
    tablet: 90rem
    mobile: 60rem
  */
  padding: 0 var(--width-content-margin);
}